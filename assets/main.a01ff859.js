var tt=Object.defineProperty,et=Object.defineProperties;var nt=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var N=(t,e,n)=>e in t?tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,u=(t,e)=>{for(var n in e||(e={}))O.call(e,n)&&N(t,n,e[n]);if(y)for(var n of y(e))R.call(e,n)&&N(t,n,e[n]);return t},h=(t,e)=>et(t,nt(e));var I=(t,e)=>{var n={};for(var o in t)O.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&y)for(var o of y(t))e.indexOf(o)<0&&R.call(t,o)&&(n[o]=t[o]);return n};import{R as a,j as b,n as st,I as ot,a as at,L as v,u as rt,B as M,b as ct,c as it,d as x,e as lt}from"./vendor.2a8141b8.js";const ut=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}};ut();function L(...t){return t.filter(e=>e&&e!==!0).join(" ")}const dt=t=>new Date().getTime()-t;function D(t,e,n=!1){const o=a.useRef(-1),r=a.useRef(new Date().getTime()),c=a.useRef(e),[i,f]=a.useState("stopped"),g=a.useCallback((m=e)=>{clearTimeout(o.current),o.current=setTimeout(()=>{p(),t()},m),r.current=new Date().getTime(),c.current=m},[t,e]),T=a.useCallback(()=>{if(c.current<=0){p();return}clearTimeout(o.current),g(c.current),f("running")},[]),S=a.useCallback(()=>{if(c.current-=dt(r.current),c.current<=0){p();return}clearTimeout(o.current),f("paused")},[]),p=a.useCallback(()=>{clearTimeout(o.current),f("stopped")},[]),d=a.useCallback(()=>{g(),f("running")},[g]);return a.useEffect(()=>{if(!!n)return d(),p},[n,d,p]),{start:d,pause:S,resume:T,cancel:p,state:i}}const ht="_toast_1x937_1";var C={toast:ht,"toast--enter":"_toast--enter_1x937_16","toast-scale-in":"_toast-scale-in_1x937_1","toast-slide-in":"_toast-slide-in_1x937_1","toast--exit":"_toast--exit_1x937_19","toast-scale-out":"_toast-scale-out_1x937_1","toast-slide-out":"_toast-slide-out_1x937_1"};const s=b.exports.jsx,l=b.exports.jsxs,B=b.exports.Fragment;function pt({id:t,title:e,body:n,duration:o}){const r=a.useRef(null),[c,i]=a.useState(!0),{deleteToast:f}=U(),g=c?"toast--enter":"toast--exit",T=L(C.toast,C[g]),S=a.useCallback(m=>{m.animationName===C["toast-scale-out"]&&f(t)},[t]),p=a.useCallback(()=>{i(!1)},[]),d=o?D(p,o,!0):null;return a.useEffect(()=>{const m=r.current,Z=m.scrollHeight;m.setAttribute("style",`--height: ${Z}px`)},[]),l("div",{ref:r,className:T,onAnimationEnd:S,onMouseEnter:()=>d==null?void 0:d.pause(),onMouseLeave:()=>d==null?void 0:d.resume(),onClick:p,children:[s("h4",{children:e}),s("p",{children:n})]})}var ft={"toast-list":"_toast-list_1j3av_1"};function mt(){const t=gt();return s("aside",{className:ft["toast-list"],children:t.map(e=>s(pt,u({},e),e.id))})}const F=a.createContext([]),j=a.createContext({emitToast:()=>0,deleteToast:()=>0});function _t({children:t}){const[e,n]=a.useState([]),o=a.useCallback(c=>{n(i=>[h(u({},c),{id:st()}),...i])},[]),r=a.useCallback(c=>{n(i=>i.filter(f=>f.id!==c))},[]);return l(j.Provider,{value:{emitToast:o,deleteToast:r},children:[t,s(F.Provider,{value:e,children:!!e.length&&s(mt,{})})]})}function gt(){return a.useContext(F)}function U(){return a.useContext(j)}function H(t){return t.toJSON().split("T")[0]}function K(){return H(new Date)}function J(){let t=new Date;return t=new Date(t.getFullYear(),t.getMonth(),1),H(t)}function X(t){return new Promise(e=>setTimeout(e,t))}const q="https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&thumbs=true";async function $(t=J(),e="desc"){const o=await(await fetch(`${q}&start_date=${t}`)).json();return await X(500),e==="asc"?o:o.reverse()}async function yt(t=K()){const n=await(await fetch(`${q}&date=${t}`)).json();return await X(1e3),n}function kt(){return JSON.parse(localStorage.getItem("spacestagram_likes")||"{}")}function Tt(t){localStorage.setItem("spacestagram_likes",JSON.stringify(t))}function G(){const[t,e]=a.useState(!1),n=a.useCallback(async o=>(e(!0),o.finally(()=>{e(!1)})),[]);return[t,n]}const St={posts:[],likes:{},startDate:"",page:0};function xt(t,e){switch(e.type){case"LOAD_POSTS":{const n=kt();return h(u({},t),{posts:e.payload,likes:n,page:0})}case"LOAD_CUSTOM_POSTS":{if(typeof e.payload=="string")break;return h(u({},t),{posts:e.payload,page:0})}case"LIKE_POST":{const n=e.payload,o=h(u({},t.likes),{[n]:!t.likes[n]});return Tt(o),h(u({},t),{likes:o})}case"SET_START_DATE":return h(u({},t),{startDate:e.payload});case"NEXT_PAGE":return t.posts.length<=10*(t.page+1)?t:h(u({},t),{page:t.page+1})}return t}function Ct(){const[t,e]=a.useReducer(xt,St),[n,o]=G(),r=a.useCallback(async(...c)=>{let i={type:c[0],payload:c[1]};switch(i.type){case"LOAD_POSTS":i.payload=await o($());break;case"LOAD_CUSTOM_POSTS":if(typeof i.payload!="string")break;e({type:"SET_START_DATE",payload:i.payload}),i.payload=await o($(i.payload,"asc"));break}e(i)},[]);return[h(u({},t),{loading:n}),r]}const Y=a.createContext(null),z=a.createContext(null);function Pt({children:t}){const[e,n]=Ct();return a.useEffect(()=>{n("LOAD_POSTS")},[n]),s(Y.Provider,{value:n,children:s(z.Provider,{value:e,children:t})})}function w(){return a.useContext(z)}function A(){return a.useContext(Y)}const bt="https://michiecodes.github.io/spacestagram-challenge";function V(){return/(\w|-)+$/.exec(bt)[0]}function E({children:t}){return l(B,{children:[l("header",{children:[s("h1",{children:"Spacetagram"}),s("p",{children:"Brought to you by NASA's Astronomy Photo of the Day (APOD) API"})]}),t[0],s("main",{children:t[1]})]})}function _(o){var r=o,{children:t,className:e}=r,n=I(r,["children","className"]);return s("button",h(u({className:L("button",e)},n),{children:t}))}var vt={"date-picker":"_date-picker_koqnu_1"};const Lt="2015-01-01",Dt=K(),wt=J();function At(){const{startDate:t}=w(),e=A(),[n,o]=a.useState(t||wt),r=a.useCallback(()=>{e("LOAD_CUSTOM_POSTS",n)},[n,e]);return l("div",{className:vt["date-picker"],children:[s("label",{htmlFor:"start-date",children:"Start Date: "}),s("input",{type:"date",id:"start-date",className:"input",min:Lt,max:Dt,value:n,onChange:c=>o(c.target.value)}),s(_,{onClick:r,children:"Browse"})]})}function Et(t,e){const n=a.useRef(),[o,r]=a.useState(0);return a.useEffect(()=>(n.current=setInterval(()=>{r(c=>(c+1)%4)},e),()=>clearInterval(n.current)),[t,e]),t+".".repeat(o)}var Nt={"rocket-loader":"_rocket-loader_l7gac_1","rocket-launch--x":"_rocket-launch--x_l7gac_1","rocket-launch--y":"_rocket-launch--y_l7gac_1"};function k({text:t}){return s("div",{className:Nt["rocket-loader"],children:l("div",{children:[s("span",{children:s(ot,{})}),s("p",{children:t})]})})}function Q(){const t=Et("Loading",250);return s(k,{text:t})}function Ot(t){return t.media_type==="image"?t.url:t.thumbnail_url}var P={"heart-icon":"_heart-icon_1unyc_1","heart-icon--show":"_heart-icon--show_1unyc_13","show-heart":"_show-heart_1unyc_1","heart-icon--hide":"_heart-icon--hide_1unyc_21","hide-heart":"_hide-heart_1unyc_1","button--liked":"_button--liked_1unyc_29"};function Rt({postID:t}){const{likes:e}=w(),n=A(),o=a.useMemo(()=>e[t],[e,t]),r=o?"heart-icon--show":"heart-icon--hide",c=L(P["heart-icon"],P[r]),i=()=>{n("LIKE_POST",t)};return l(_,{className:o?P["button--liked"]:void 0,onClick:i,children:[s(at,{className:c}),s("span",{children:o?"Liked":"Like"})]})}function It(t){navigator.clipboard.writeText(t)}const $t=t=>`${location.origin}/${V()}/posts/${t}`;function Mt({post:t}){const[e,n]=a.useState("Share"),{emitToast:o}=U(),r=D(a.useCallback(()=>n("Share"),[]),1200);return s(_,{onClick:()=>{It($t(t.date)),n("Copied"),r.start(),o({title:"Successfully Shared Post",body:`Copied Link to ${t.title} - ${t.date}`,duration:2500})},children:e})}var Bt={"post-list__post":"_post-list__post_1lfzb_1"};function W({post:t}){return l("article",{className:Bt["post-list__post"],children:[s("img",{src:Ot(t),alt:t.title}),l("figcaption",{children:[s("h3",{children:l(v,{to:`/posts/${t.date}`,children:[t.title," - ",t.date]})}),s("p",{children:t.explanation}),l("div",{children:[s(Rt,{postID:t.date}),s(Mt,{post:t})]})]})]})}var Ft={"load-button":"_load-button_law24_1"};function jt(){const[t,e]=a.useState("Load More"),n=A(),o=D(a.useCallback(()=>e("Load More"),[]),1200),r=()=>{e("Loading..."),n("NEXT_PAGE"),o.start()};return s(_,{className:Ft["load-button"],onClick:r,children:t})}function Ut(){const{posts:t,loading:e,page:n}=w(),o=a.useMemo(()=>t.slice(0,10*(n+1)),[t,n]);return s("section",{className:"post-list",children:e?s(Q,{}):(o==null?void 0:o.length)?l(B,{children:[o.map(r=>s(W,{post:r},r.date)),o.length!=t.length&&s(jt,{})]}):s(k,{text:"No Posts Found"})})}function Ht(){return l(E,{children:[s(At,{}),s(Ut,{})]})}function Kt(){const[t,e]=a.useState(),[n,o]=G(),{postID:r}=rt(),c=a.useCallback(async()=>{e(await o(yt(r)))},[r]);return a.useEffect(()=>{c()},[]),l(E,{children:[s(v,{to:"/",children:l(_,{style:{marginBottom:"2rem"},children:[s(M,{}),s("span",{style:{marginLeft:"0.75rem"},children:"View All Posts"})]})}),s("section",{className:"post-list",children:n?s(Q,{}):t?s(W,{post:t}):s(k,{text:"No Posts Found"})})]})}function Jt(){return l(E,{children:[s(v,{to:"/",children:l(_,{style:{marginBottom:"2rem"},children:[s(M,{}),s("span",{style:{marginLeft:"0.75rem"},children:"Back To Home"})]})}),s("section",{className:"post-list",children:s(k,{text:"Page Could Not Be Found"})})]})}function Xt(){return s("div",{className:"app",children:s(Pt,{children:s(ct,{basename:V(),children:l(it,{children:[s(x,{path:"/",element:s(Ht,{})}),s(x,{path:"/posts/:postID",element:s(Kt,{})}),s(x,{path:"*",element:s(Jt,{})})]})})})})}lt.render(s(a.StrictMode,{children:s(_t,{children:s(Xt,{})})}),document.getElementById("root"));
