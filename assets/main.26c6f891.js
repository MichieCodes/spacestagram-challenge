var st=Object.defineProperty,ot=Object.defineProperties;var at=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var $=(t,e,n)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))B.call(e,n)&&$(t,n,e[n]);if(S)for(var n of S(e))F.call(e,n)&&$(t,n,e[n]);return t},_=(t,e)=>ot(t,at(e));var j=(t,e)=>{var n={};for(var o in t)B.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&S)for(var o of S(t))e.indexOf(o)<0&&F.call(t,o)&&(n[o]=t[o]);return n};import{R as a,j as w,n as rt,I as ct,a as it,L as A,u as lt,B as U,b as ut,c as dt,d as C,e as ht}from"./vendor.2a8141b8.js";const pt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}};pt();function O(...t){return t.filter(e=>e&&e!==!0).join(" ")}const ft=t=>new Date().getTime()-t;function E(t,e,n=!1){const o=a.useRef(-1),r=a.useRef(new Date().getTime()),c=a.useRef(e),[i,u]=a.useState("stopped"),d=a.useCallback((g=e)=>{clearTimeout(o.current),o.current=setTimeout(()=>{m(),t()},g),r.current=new Date().getTime(),c.current=g},[t,e]),f=a.useCallback(()=>{if(c.current<=0){m();return}clearTimeout(o.current),d(c.current),u("running")},[]),k=a.useCallback(()=>{if(c.current-=ft(r.current),c.current<=0){m();return}clearTimeout(o.current),u("paused")},[]),m=a.useCallback(()=>{clearTimeout(o.current),u("stopped")},[]),h=a.useCallback(()=>{d(),u("running")},[d]);return a.useEffect(()=>{if(!!n)return h(),m},[n,h,m]),{start:h,pause:k,resume:f,cancel:m,state:i}}const mt="_toast_1x937_1";var b={toast:mt,"toast--enter":"_toast--enter_1x937_16","toast-scale-in":"_toast-scale-in_1x937_1","toast-slide-in":"_toast-slide-in_1x937_1","toast--exit":"_toast--exit_1x937_19","toast-scale-out":"_toast-scale-out_1x937_1","toast-slide-out":"_toast-slide-out_1x937_1"};const s=w.exports.jsx,l=w.exports.jsxs,H=w.exports.Fragment;function _t({id:t,title:e,body:n,duration:o}){const r=a.useRef(null),[c,i]=a.useState(!0),{deleteToast:u}=X(),d=c?"toast--enter":"toast--exit",f=O(b.toast,b[d]),k=a.useCallback(g=>{g.animationName===b["toast-scale-out"]&&u(t)},[t]),m=a.useCallback(()=>{i(!1)},[]),h=o?E(m,o,!0):null;return a.useEffect(()=>{const g=r.current,nt=g.scrollHeight;g.setAttribute("style",`--height: ${nt}px`)},[]),l("div",{ref:r,className:f,onAnimationEnd:k,onMouseEnter:()=>h==null?void 0:h.pause(),onMouseLeave:()=>h==null?void 0:h.resume(),onClick:m,children:[s("h4",{children:e}),s("p",{children:n})]})}var gt={"toast-list":"_toast-list_1j3av_1"};function yt(){const t=Tt();return s("aside",{className:gt["toast-list"],children:t.map(e=>s(_t,p({},e),e.id))})}const K=a.createContext([]),J=a.createContext({emitToast:()=>0,deleteToast:()=>0});function kt({children:t}){const[e,n]=a.useState([]),o=a.useCallback(c=>{n(i=>[_(p({},c),{id:rt()}),...i])},[]),r=a.useCallback(c=>{n(i=>i.filter(u=>u.id!==c))},[]);return l(J.Provider,{value:{emitToast:o,deleteToast:r},children:[t,s(K.Provider,{value:e,children:!!e.length&&s(yt,{})})]})}function Tt(){return a.useContext(K)}function X(){return a.useContext(J)}function N(t){return t.toJSON().split("T")[0]}function q(t){return new Date(t+"T00:00:00")}function M(){return N(new Date)}function G(){let t=new Date;return t=new Date(t.getFullYear(),t.getMonth(),1),N(t)}function T(t){let n=new Date().getTime()-q(t).getTime();return Math.round(n/864e5)}function L(t,e){if(!e)return t;let n=q(t);return n.setDate(n.getDate()+e-(e>0?1:-1)),N(n)}function St(t,...e){const n=new URL(t);for(const o of e){if(typeof o=="boolean")break;n.searchParams.append(...o)}return n.href}function Y(t){return new Promise(e=>setTimeout(e,t))}const z="https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&thumbs=true";async function Pt(t=G(),e="desc",n){const o=St(z,["start_date",t],!!n&&["end_date",n]),c=await(await fetch(o)).json();return await Y(500),e==="asc"?c:c.reverse()}async function xt(t=M()){const n=await(await fetch(`${z}&date=${t}`)).json();return await Y(1e3),n}async function v(t=M(),e=10,n="desc"){t=n==="desc"?L(t,-e):t;const o=T(t)<=e?"":L(t,e);return await Pt(t,n,o)}function Ct(){return JSON.parse(localStorage.getItem("spacestagram_likes")||"{}")}function bt(t){localStorage.setItem("spacestagram_likes",JSON.stringify(t))}function V(){const[t,e]=a.useState(!1),n=a.useCallback(async o=>(e(!0),o.finally(()=>{e(!1)})),[]);return[t,n]}const vt={posts:[],likes:{},startDate:"",totalPosts:T(G())+1};function Dt(t,e){switch(e.type){case"LOAD_POSTS":{if(!e.payload)break;const n=Ct();return _(p({},t),{posts:e.payload,likes:n,totalPosts:T("2015-01-01")})}case"LOAD_CUSTOM_POSTS":{if(typeof e.payload=="string")break;let{posts:n,append:o}=e.payload;return o&&(n=[...t.posts,...n]),_(p({},t),{posts:n})}case"LIKE_POST":{const n=e.payload,o=_(p({},t.likes),{[n]:!t.likes[n]});return bt(o),_(p({},t),{likes:o})}case"SET_START_DATE":return _(p({},t),{startDate:e.payload,totalPosts:T(e.payload)+1})}return t}function Lt(){const[t,e]=a.useReducer(Dt,vt),[n,o]=V(),r=a.useCallback(async(...c)=>{let i={type:c[0],payload:c[1]};switch(i.type){case"LOAD_POSTS":i.payload=await o(v());break;case"LOAD_CUSTOM_POSTS":if(typeof i.payload!="string")break;e({type:"SET_START_DATE",payload:i.payload}),i.payload={posts:await o(v(i.payload,10,"asc")),append:!1};break;case"NEXT_PAGE":const{date:u,count:d,order:f}=i.payload,k={type:"LOAD_CUSTOM_POSTS",payload:{posts:await v(L(u,2*(f==="asc"?1:-1)),d,f),append:!0}};e(k);break}e(i)},[]);return[_(p({},t),{loading:n}),r]}const Q=a.createContext(null),W=a.createContext(null);function wt({children:t}){const[e,n]=Lt();return a.useEffect(()=>{n("LOAD_POSTS")},[n]),s(Q.Provider,{value:n,children:s(W.Provider,{value:e,children:t})})}function P(){return a.useContext(W)}function R(){return a.useContext(Q)}const At="https://michiecodes.github.io/spacestagram-challenge";function Z(){return/(\w|-)+$/.exec(At)[0]}function I({children:t}){return l(H,{children:[l("header",{children:[s("h1",{children:"Spacetagram"}),s("p",{children:"Brought to you by NASA's Astronomy Photo of the Day (APOD) API"})]}),t[0],s("main",{children:t[1]})]})}function y(o){var r=o,{children:t,className:e}=r,n=j(r,["children","className"]);return s("button",_(p({className:O("button",e)},n),{children:t}))}var Ot={"date-picker":"_date-picker_koqnu_1"};const Et="2015-01-01",Nt=M();function Mt(){const{startDate:t}=P(),e=R(),[n,o]=a.useState(t||""),r=a.useCallback(()=>{e("LOAD_CUSTOM_POSTS",n)},[n,e]);return l("div",{className:Ot["date-picker"],children:[s("label",{htmlFor:"start-date",children:"Start Date: "}),s("input",{type:"date",id:"start-date",className:"input",min:Et,max:Nt,value:n,onChange:c=>o(c.target.value)}),s(y,{onClick:r,children:"Browse"})]})}function Rt(t,e){const n=a.useRef(),[o,r]=a.useState(0);return a.useEffect(()=>(n.current=setInterval(()=>{r(c=>(c+1)%4)},e),()=>clearInterval(n.current)),[t,e]),t+".".repeat(o)}var It={"rocket-loader":"_rocket-loader_l7gac_1","rocket-launch--x":"_rocket-launch--x_l7gac_1","rocket-launch--y":"_rocket-launch--y_l7gac_1"};function x({text:t}){return s("div",{className:It["rocket-loader"],children:l("div",{children:[s("span",{children:s(ct,{})}),s("p",{children:t})]})})}function tt(){const t=Rt("Loading",250);return s(x,{text:t})}function $t(t){return t.media_type==="image"?t.url:t.thumbnail_url}var D={"heart-icon":"_heart-icon_1unyc_1","heart-icon--show":"_heart-icon--show_1unyc_13","show-heart":"_show-heart_1unyc_1","heart-icon--hide":"_heart-icon--hide_1unyc_21","hide-heart":"_hide-heart_1unyc_1","button--liked":"_button--liked_1unyc_29"};function Bt({postID:t}){const{likes:e}=P(),n=R(),o=a.useMemo(()=>e[t],[e,t]),r=o?"heart-icon--show":"heart-icon--hide",c=O(D["heart-icon"],D[r]),i=()=>{n("LIKE_POST",t)};return l(y,{className:o?D["button--liked"]:void 0,onClick:i,children:[s(it,{className:c}),s("span",{children:o?"Liked":"Like"})]})}function Ft(t){navigator.clipboard.writeText(t)}const jt=t=>`${location.origin}/${Z()}/posts/${t}`;function Ut({post:t}){const[e,n]=a.useState("Share"),{emitToast:o}=X(),r=E(a.useCallback(()=>n("Share"),[]),1200);return s(y,{onClick:()=>{Ft(jt(t.date)),n("Copied"),r.start(),o({title:"Successfully Shared Post",body:`Copied Link to ${t.title} - ${t.date}`,duration:2500})},children:e})}var Ht={"post-list__post":"_post-list__post_1lfzb_1"};function et({post:t}){return l("article",{className:Ht["post-list__post"],children:[s("img",{src:$t(t),alt:t.title}),l("figcaption",{children:[s("h3",{children:l(A,{to:`/posts/${t.date}`,children:[t.title," - ",t.date]})}),s("p",{children:t.explanation}),l("div",{children:[s(Bt,{postID:t.date}),s(Ut,{post:t})]})]})]})}var Kt={"load-button":"_load-button_law24_1"};function Jt(){const[t,e]=a.useState("Load More"),{posts:n,startDate:o}=P()||{},r=R(),c=E(a.useCallback(()=>e("Load More"),[]),2e3),i=a.useMemo(()=>{var f;const d=(f=n==null?void 0:n.slice(-1)[0])==null?void 0:f.date;return{date:d,count:Math.min(T(d),10),order:o?"asc":"desc"}},[n,o]),u=()=>{e("Loading..."),r("NEXT_PAGE",i),c.start()};return s(y,{className:Kt["load-button"],onClick:u,disabled:c.state=="running",children:t})}function Xt(){const{posts:t,loading:e,totalPosts:n}=P();return s("section",{className:"post-list",children:e?s(tt,{}):(t==null?void 0:t.length)?l(H,{children:[t.map(o=>s(et,{post:o},o.date)),t.length!=n&&s(Jt,{})]}):s(x,{text:"No Posts Found"})})}function qt(){return l(I,{children:[s(Mt,{}),s(Xt,{})]})}function Gt(){const[t,e]=a.useState(),[n,o]=V(),{postID:r}=lt(),c=a.useCallback(async()=>{e(await o(xt(r)))},[r]);return a.useEffect(()=>{c()},[]),l(I,{children:[s(A,{to:"/",children:l(y,{style:{marginBottom:"2rem"},children:[s(U,{}),s("span",{style:{marginLeft:"0.75rem"},children:"View All Posts"})]})}),s("section",{className:"post-list",children:n?s(tt,{}):t?s(et,{post:t}):s(x,{text:"No Posts Found"})})]})}function Yt(){return l(I,{children:[s(A,{to:"/",children:l(y,{style:{marginBottom:"2rem"},children:[s(U,{}),s("span",{style:{marginLeft:"0.75rem"},children:"Back To Home"})]})}),s("section",{className:"post-list",children:s(x,{text:"Page Could Not Be Found"})})]})}function zt(){return s("div",{className:"app",children:s(wt,{children:s(ut,{basename:Z(),children:l(dt,{children:[s(C,{path:"/",element:s(qt,{})}),s(C,{path:"/posts/:postID",element:s(Gt,{})}),s(C,{path:"*",element:s(Yt,{})})]})})})})}ht.render(s(a.StrictMode,{children:s(kt,{children:s(zt,{})})}),document.getElementById("root"));
